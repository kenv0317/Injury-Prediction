# Injury-Prediction

 MLB(メジャーリーグ) のシーズンデータを用いて将来怪我する可能性のある選手(投手)を機械学習を用いて予測するプログラムです。  
 MLB の過去 5 年以上のデータを用いてその期間内に出場経験のある全投手成績を取得します。また選手の怪我のデータとして、MLBの怪我人についての データを取得します。
 取得したデータからデータセットを作成し、欠損値・外れ値などの処理を行います。
 前処理済みのデータセットを用いて複数のモデルを作成し、複数の評価指標を用いてどのモデルが最適で あるかを検討する予定です。


## 構成
![怪我予測_構成図](https://github.com/kenv0317/Injury-Prediction/assets/71165696/065fe7ab-1b78-4143-bf0d-d2a12523ac83)

## 各ファイルについて
- Database_Ceration_2015_2022.ipynb (2015~2022シーズン 成績+怪我データセット作成プログラム)
- Database_Creation_2023.ipynb  (2023シーズン 成績+怪我データセット作成プログラム)
- Filter_Method.ipynb  (特徴量選択プログラムFilter法)
- Wrapper_Method.ipynb (特徴量選択プログラムWrapper法)
- Models.ipynb (モデル実行+評価プログラム)

 ## 使用技術
- Python
- PyBaseball
- BeautifulSoup
- Pandas
- Numpy
- Scikit-learn

## データセットの作成について
Pythonライブラリにある PyBaseball を利用 することで、MLB における順位や結果などの基本的なチーム情報や、個人成績も、打率、防御率などの基本情報から、1 球 1 球の回転数や、個々の打球の速度や角度などあらゆる情報を取得することができる。
そのため、PyBaseballを利用して、MLBの過去5年以上の内に出場経験のある全投手成績を取得する。
また選手の怪我のデータに関しては、MLBの怪我人のデータが記載されているWebサイト(https://www.spotrac.com/mlb/injured-list/2022/cumulative-player/) からWebスクレイピングで必要なデータを取得する。

## 特徴量の候補
- 基本情報 (年齢、身長、体重など)
- 怪我情報 (怪我の有無、怪我の種類など) 
- シーズン成績 (投球イニング数、勝利数、敗北数、失点数、四球数、死球数、奪三振数、防御率など)
- 投球データ (球種、球速、リリースポイントなど)

## 特徴量選択で用いる手法
- Filter法
- Wrapper法

## 目的変数
今後 (来シーズン) の怪我の有無だけでなく、怪我する可能性のある部位 (肩、肘、背中など) に関しても予測する。そのため、目的変数の候補は、怪我の有無、肩の怪我の有無、肘の怪我の有無、背中の怪我の有無などである。

## モデルの候補
- ロジスティック回帰 
- ランダムフォレスト 
- k近傍探索
- XGBoost

## 評価指標の候補
- 正解率
- F値
- AUC

